<!DOCTYPE html>
<html lang="en-UK">
	<head prefix="og: http://ogp.me/ns#">
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="application-name" content="KnowsCount's Blog" />
	<meta name="apple-mobile-web-app-status-bar-style" content="#fff" />
	<meta name="apple-mobile-web-app-title" content="KnowsCount's Blog" />
	<title>
		üñ≤ ‰ªÄ‰πàÊòØ‰ø°ÊÅØËåßÊàø - KnowsCount's Blog
	</title>
	<link
		rel="alternate"
		href="http://localhost:4000/info-cocoons/"
		hreflang="en-UK"
	/>
	<link
		rel="canonical"
		href="http://localhost:4000/info-cocoons/"
	/>
	 
	<meta
		name="description"
		content="I am a poet."
	/>
	<meta name="referrer" content="no-referrer-when-downgrade" />
	<meta property="fb:app_id" content="" />
	<meta
		property="og:site_name"
		content="üñ≤ ‰ªÄ‰πàÊòØ‰ø°ÊÅØËåßÊàø | KnowsCount"
	/>
	<meta
		property="og:title"
		content="üñ≤ ‰ªÄ‰πàÊòØ‰ø°ÊÅØËåßÊàø | KnowsCount"
	/>
	
	<meta property="og:type" content="website" />
	
	<meta
		property="og:url"
		content="http://localhost:4000/info-cocoons/"
	/>
	<meta
		property="og:description"
		content="I am a poet."
	/>
	
	<meta property="og:image" content="http://localhost:4000/assets/img/ogp.png" />
	
	<meta property="og:image:width" content="640" />
	<meta property="og:image:height" content="640" />
	<meta name="twitter:card" content="summary" />
	<meta
		name="twitter:title"
		content="üñ≤ ‰ªÄ‰πàÊòØ‰ø°ÊÅØËåßÊàø | knowscount"
	/>
	<meta
		name="twitter:url"
		content="http://localhost:4000/info-cocoons/"
	/>
	<meta name="twitter:site" content="@knowscount" />
	<meta name="twitter:creator" content="@knowscount" />
	<meta
		name="twitter:description"
		content="I am a poet."
	/>
	
	<meta name="twitter:image" content="http://localhost:4000/assets/img/ogp.png" />
	 <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="KnowsCount&apos;s Blog" />
	<link
		rel="apple-touch-icon"
		sizes="180x180"
		href="/assets/favicons/apple-touch-icon.png"
	/>
	<link
		rel="icon"
		type="image/png"
		sizes="32x32"
		href="/assets/favicons/favicon-32x32.png"
	/>
	<link
		rel="icon"
		type="image/png"
		sizes="16x16"
		href="/assets/favicons/favicon-16x16.png"
	/>
	<link rel="manifest" href="/assets/favicons/site.webmanifest" />
	<link
		rel="mask-icon"
		href="/assets/favicons/safari-pinned-tab.svg"
		color="#5bbad5"
	/>
	<meta name="apple-mobile-web-app-title" content="Jekyll Klise" />
	<meta name="application-name" content="Jekyll Klise" />
	<meta name="msapplication-TileColor" content="#da532c" />
	<meta name="theme-color" content="#2c2c2c" />

	<link rel="stylesheet" href="/assets/css/style.css" />
	<meta
		name="google-site-verification"
		content="tYpcDp6dpktMEzRmAyRbJXydqOBuCTzV3AeDFHuE60M"
	/>
</head>

	<body data-theme="light" class="notransition">
		<script
			async
			src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"
		></script>
		<script>
			const body = document.body
			const data = body.getAttribute('data-theme')

			const initTheme = (state) => {
				if (state === 'dark') {
					body.setAttribute('data-theme', 'dark')
				} else if (state === 'light') {
					body.removeAttribute('data-theme')
				} else {
					localStorage.setItem('theme', data)
				}
			}

			initTheme(localStorage.getItem('theme'))

			setTimeout(() => body.classList.remove('notransition'), 75)
		</script>

		<div class="navbar" role="navigation">
  <nav class="menu">
    <input type="checkbox" id="menu-trigger" class="menu-trigger" />
    <label for="menu-trigger">
      <span class="menu-icon">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <path
            d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"
          />
        </svg>
      </span>
    </label>
    <a id="mode">
      <svg
        class="mode-sunny"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 512 512"
      >
        <title>LIGHT</title>
        <line
          x1="256"
          y1="48"
          x2="256"
          y2="96"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="256"
          y1="416"
          x2="256"
          y2="464"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="108.92"
          x2="369.14"
          y2="142.86"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="369.14"
          x2="108.92"
          y2="403.08"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="464"
          y1="256"
          x2="416"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="96"
          y1="256"
          x2="48"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="403.08"
          x2="369.14"
          y2="369.14"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="142.86"
          x2="108.92"
          y2="108.92"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <circle
          cx="256"
          cy="256"
          r="80"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
      </svg>
      <svg
        class="mode-moon"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 512 512"
      >
        <title>DARK</title>
        <line
          x1="256"
          y1="48"
          x2="256"
          y2="96"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="256"
          y1="416"
          x2="256"
          y2="464"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="108.92"
          x2="369.14"
          y2="142.86"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="369.14"
          x2="108.92"
          y2="403.08"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="464"
          y1="256"
          x2="416"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="96"
          y1="256"
          x2="48"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="403.08"
          x2="369.14"
          y2="369.14"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="142.86"
          x2="108.92"
          y2="108.92"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <circle
          cx="256"
          cy="256"
          r="80"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
      </svg>
    </a>
    <div class="trigger">
      <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/reflections/">reflections</a><a class="menu-link" href="/about/">about</a><a class="menu-link rss" href="/feed.xml">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="17"
            height="17"
            viewBox="0 0 512 512"
            fill="#ED812E"
          >
            <title>RSS</title>
            <path
              d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"
            />
            <path
              d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"
            />
            <path
              d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"
            />
          </svg>
        </a>
      </div>
    </div>
  </nav>
</div>

		<div class="wrapper post">
			<main class="page-content" aria-label="Content">
				<article itemscope itemtype="https://schema.org/BlogPosting">
					<header class="header">
						
						<div class="tags">
							
							<span itemprop="keywords">
								
								<a
									class="tag"
									href="/tags/#blog"
									>BLOG</a
								> 
							</span>
						</div>
						
						<h1 class="header-title" itemprop="headline">
							üñ≤ ‰ªÄ‰πàÊòØ‰ø°ÊÅØËåßÊàø
						</h1>
						
						<div class="post-meta">
							<time
								datetime="2021-01-15T00:00:00+00:00"
								itemprop="datePublished"
							>
								Jan 15, 2021
							</time>
							&nbsp;
							<span
								itemprop="author"
								itemscope
								itemtype="https://schema.org/Person"
							>
								<span itemprop="name"
									>KnowsCount</span
								>
							</span>
							<span>|</span>
							<span id="busuanzi_container_page_pv"
								>viewed:
								<span id="busuanzi_value_page_pv"></span>
								times</span
							>
							<time
								hidden
								datetime=""
								itemprop="dateModified"
							>
								Jan 15, 2021
							</time>
							<span hidden itemprop="publisher" itemtype="Person"
								>KnowsCount</span
							>
							<span hidden itemprop="image"
								></span
							>
							<span hidden itemprop="mainEntityOfPage"
								><h2 id="ÂΩì‰ªäÊàë‰ª¨Ê¥ªÂú®‰∏Ä‰∏™ÁÆóÊ≥ïÁªüÊ≤ªÁöÑ‰∫íËÅîÁΩëÈáå">ÂΩì‰ªäÔºåÊàë‰ª¨Ê¥ªÂú®‰∏Ä‰∏™ÁÆóÊ≥ïÁªüÊ≤ªÁöÑ‰∫íËÅîÁΩëÈáå„ÄÇ</h2>
</span
							>
						</div>
						
					</header>

					<div class="page-content" itemprop="articleBody">
						<h2 id="ÂΩì‰ªäÊàë‰ª¨Ê¥ªÂú®‰∏Ä‰∏™ÁÆóÊ≥ïÁªüÊ≤ªÁöÑ‰∫íËÅîÁΩëÈáå">
        
        
          <a href="#ÂΩì‰ªäÊàë‰ª¨Ê¥ªÂú®‰∏Ä‰∏™ÁÆóÊ≥ïÁªüÊ≤ªÁöÑ‰∫íËÅîÁΩëÈáå" class="anchor-head"></a> ÂΩì‰ªäÔºåÊàë‰ª¨Ê¥ªÂú®‰∏Ä‰∏™ÁÆóÊ≥ïÁªüÊ≤ªÁöÑ‰∫íËÅîÁΩëÈáå„ÄÇ
        
        
      </h2>

<p>AI ÁÅ≠Áªù‰∫∫Á±ªÔºåËøòÂ§™ÈÅ•ËøúÔºõAI ‰∏ªÂÆ∞‰∫∫Á±ªÔºå‰∏öÂ∑≤ÂºÄÂßã„ÄÇ</p>
    <hr />

<p>Ê†áÈ¢òËØ¥ÔºåÈÄÉÁ¶ª‰ø°ÊÅØËåßÊàøÔºåÂèØ‰ø°ÊÅØËåßÊàøÊòØ‰ªÄ‰πàÔºü</p>
      <h3 id="‰ø°ÊÅØÊ∂àË¥π‰∏™‰∫∫Âåñ">
        
        
          <a href="#‰ø°ÊÅØÊ∂àË¥π‰∏™‰∫∫Âåñ" class="anchor-head"></a> ‰ø°ÊÅØÊ∂àË¥π‰∏™‰∫∫Âåñ
        
        
      </h3>

<p>Áé∞Âú®ÂêÑÂ§ßÂÜÖÂÆπÂπ≥Âè∞ËÉåÂêéÈÉΩÊúâÂº∫Â§ßÁöÑÁÆóÊ≥ïÊîØÊíëÔºå‰ª•Â∏¶ÁªôÂú®Â∫ßËØ∏‰Ωç‰ªñ‰ª¨ÊÉ≥Ë¶ÅÁúãÂà∞ÁöÑÂÜÖÂÆπ„ÄÇÂê¨Ëµ∑Êù•ÂæàÂ•ΩÔºå‰∏çÊòØ‰πàÔºü‚Äî‚Äî‰ΩÜÊòØÔºåÂú®ËøôÂêåÊó∂Ôºå‰ªñ‰ª¨ÁöÑÁ¨¨‰∏ÄÁõÆÁöÑÂÖ∂ÂÆûÊòØËÆ©‰ΩøÁî®ËÄÖÂ∞ΩÂèØËÉΩÂú∞Ê∂àË¥πÊõ¥Â§ö‰∏úË•øÔºöÂÜÖÂÆπ„ÄÅÂïÜÂìÅ„ÄÅÊó∂Èó¥ÔºåÂõ†ËÄåÊèêÈ´òÂÖ∂ÊµÅÈáèÊî∂Áõä„ÄÇ</p>

<p>Âú®Êàë‰ª¨ÊüêÂÆùÊó∂ÔºåÈ¶ñÈ°µÂü∫Êú¨ÊòØÂâç‰∏ÄÊ¨°ÊêúÁ¥¢Áâ©ÂìÅÁöÑÂêåÊ¨æÔºõÂú®Êàë‰ª¨Êüê‰πéÊó∂ÔºåÊêúÁ¥¢ÊàñËÄÖÁÇπËµû„ÄÅËØÑËÆ∫„ÄÅÊî∂Ëóè‰∫ÜÊüêÂÜÖÂÆπÔºåÊé•‰∏ãÊù•‰ºöË∂äÊù•Ë∂äÂ§öÊé®ËçêÁõ∏‰ººÁöÑÂÜÖÂÆπÔºõÂú®Êàë‰ª¨Êäñ y Êó∂ÔºåÁúãÂà∞ÁöÑÊñ∞ÂÜÖÂÆπÊú¨Ë¥®ÈÉΩÊòØÁõ∏‰ººÁöÑÔºõ</p>

<p><img src="https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/facebook.jpeg" alt="facebook" /></p>

<p>ÊâÄ‰ª•Ôºå‰Ω†ÂèØ‰ª•‰∏∫Ëá™Â∑±ÊâìÈÄ†‰∏Ä‰ªΩ„Äå‰∏™‰∫∫Êó•Êä•„Äç„ÄÇÊöÇ‰∏î‰∏çÊÅêÊÄñÂêßÔºüÊòØÁöÑÔºåËøò‰∏çÊÅêÊÄñ„ÄÇ</p>
    
      <h3 id="Ê∂àË¥πÂÜÖÂÆπÈáçÂ§çÂåñ">
        
        
          <a href="#Ê∂àË¥πÂÜÖÂÆπÈáçÂ§çÂåñ" class="anchor-head"></a> Ê∂àË¥πÂÜÖÂÆπÈáçÂ§çÂåñ
        
        
      </h3>

<p>‰∏çËøáÔºåËøôÂú®Êª°Ë∂≥‰Ω†ÁöÑÂ§ßËÑëÂèçÈ¶àÊú∫Âà∂ÁöÑÂêåÊó∂ÔºåËøôÁßç‰ª•Áî®Êà∑ÁîªÂÉèÂÆûÁé∞ÁöÑ‰∏™ÊÄßÂåñ‰πü‰ºöÁºñÁªá‰∏Ä‰∏™„Äå‰ø°ÊÅØËåßÊàø„Äç‚Äî‚ÄîÂÜÖÂÆπÁöÑÂêåË¥®Âåñ„ÄÇÊõ¥ËØ¶ÁªÜ‰∏Ä‰∫õÔºö</p>

<blockquote>
  <p>‰ø°ÊÅØËåßÊàøÊòØÊåá‰∫∫‰ª¨ÂÖ≥Ê≥®ÁöÑ‰ø°ÊÅØÈ¢ÜÂüü‰ºö‰π†ÊÉØÊÄßÂú∞Ë¢´Ëá™Â∑±ÁöÑÂÖ¥Ë∂£ÊâÄÂºïÂØºÔºå‰ªéËÄåÂ∞ÜËá™Â∑±ÁöÑÁîüÊ¥ªÊ°éÊ¢è‰∫éÂÉèËöïËåß‰∏ÄËà¨ÁöÑ‚ÄúËåßÊàø‚Äù‰∏≠ÁöÑÁé∞Ë±°„ÄÇ Áî±‰∫é‰ø°ÊÅØÊäÄÊúØÊèê‰æõ‰∫ÜÊõ¥Ëá™ÊàëÁöÑÊÄùÊÉ≥Á©∫Èó¥Âíå‰ªª‰ΩïÈ¢ÜÂüüÁöÑÂ∑®ÈáèÁü•ËØÜÔºå‰∏Ä‰∫õ‰∫∫ËøòÂèØËÉΩËøõ‰∏ÄÊ≠•ÈÄÉÈÅøÁ§æ‰ºö‰∏≠ÁöÑÁßçÁßçÁüõÁõæÔºåÊàê‰∏∫‰∏é‰∏ñÈöîÁªùÁöÑÂ≠§Á´ãËÄÖ„ÄÇ</p>
</blockquote>

<p>‰∫∫‰ª¨Êõ¥ÊÑøÊÑèÊé•Ëß¶Ëá™Â∑±ÊÑüÂÖ¥Ë∂£ÁöÑÂÜÖÂÆπÔºåËøôÂèó‰∫∫ÁöÑÂ§©ÊÄßÊàñËÄÖËØ¥ÊÄùÊÉ≥ÊÉ∞ÊÄßÁöÑÂà∂Á∫¶ÔºåËÄåÊäÄÊúØÂÖ¨Âè∏Â∞±ÊòØÂà©Áî®‰∫ÜËøôÊ†∑ÁöÑÂº±ÁÇπÔºå‰∫éÊó†ÂΩ¢‰πã‰∏≠ËØ±ÂØº‰Ω†ËøõÂÖ•‰ø°ÊÅØÂØÜÈó≠ÁöÑÁ©∫Èó¥ÔºåÊää‰Ω†Âõ∞Âú®‰∏ÄÊ†∑ÁöÑÂ£∞Èü≥ÈáåÔºå‰∏éÁúüÊ≠£ÁöÑÁ§æ‰ºöËÑ±Èí©„ÄÇÊÄé‰πàÊ†∑ÔºåÊÅêÊÄñ‰∫Ü‰πàÔºü</p>
    
      <h3 id="Ê∂àË¥πÁæ§‰ΩìÂâ≤Ë£ÇÂåñ">
        
        
          <a href="#Ê∂àË¥πÁæ§‰ΩìÂâ≤Ë£ÇÂåñ" class="anchor-head"></a> Ê∂àË¥πÁæ§‰ΩìÂâ≤Ë£ÇÂåñ
        
        
      </h3>

<p>Ëøô‰ºöÈÄ†Êàê‰ªÄ‰πàÔºü‚Äî‚ÄîÁΩëÁªúÁ©∫Èó¥Â∑¥Â∞îÂπ≤ÂåñÔºåÊääÊâÄÊúâ‰∫∫ÂàÜË£ÇÊàêÊúâÁùÄ‰∏çÂêåÂà©ÁõäÁõÆÊ†á„ÄÅ‰ª∑ÂÄº‰ø°‰ª∞„ÄÅÂÖ¥Ë∂£ÂèñÂêëÁöÑÁπÅÂ§öÁæ§Á±ªÔºåÂπ∂Â∞ÜÊâÄÊúâ‰∫∫Âõ∞Âú®Ëá™Â∑±ÁöÑËåßÊàøÈáå„ÄÇ</p>
    <hr />

<p>Ê†áÈ¢òÂèàËØ¥Ôºå„ÄåÈÄÉÁ¶ª„Äç‰ø°ÊÅØËåßÊàøÔºåÊàë‰ª¨‰∏∫‰ªÄ‰πàË¶ÅÈÄÉÁ¶ªÔºüË¶ÅÊÄé‰πàÈÄÉÔºü</p>
      <h3 id="‰∏∫‰ªÄ‰πà">
        
        
          <a href="#‰∏∫‰ªÄ‰πà" class="anchor-head"></a> ‰∏∫‰ªÄ‰πàÔºü
        
        
      </h3>

<p>‰ø°ÊÅØËåßÊàøËÉΩÁªô‰∏ñÁïåÂ∏¶Êù•Êó†Â∞ΩÁöÑ‰º§ÂÆ≥ÔºåÈöè‰æø‰∏æÂá†‰∏™‰æãÂ≠êÔºö</p>

<p><em>‰∏™‰∫∫ËÆ§Áü•Á™ÑÂåñ„ÄÅÊóèÁæ§ÊûÅÂåñ„ÄÅËôöÂÅá‰ø°ÊÅØÊ≥õÊª•„ÄÅÂΩ±ÂìçÁ§æ‰ºöÁ®≥ÂÆö‚Ä¶‚Ä¶</em></p>
    
      <h3 id="Âπ≥Âè∞ÁÆóÊ≥ïÁöÑ‰ºòÂåñ">
        
        
          <a href="#Âπ≥Âè∞ÁÆóÊ≥ïÁöÑ‰ºòÂåñ" class="anchor-head"></a> Âπ≥Âè∞ÁÆóÊ≥ïÁöÑ‰ºòÂåñ
        
        
      </h3>

<p>Âú®ÁÆóÊ≥ïÁêÜËÆ∫‰∏≠ÔºåÊúâ‰∏Ä‰∏™ EE ÈóÆÈ¢òÔºàExploration and Exploitation tradeoffÔºâÔºåÁõ¥Êé•ËØëËøáÊù•Â∞±ÊòØ„ÄåÊé¢Á¥¢-Âà©Áî®„ÄçÈóÆÈ¢ò„ÄÇ</p>

<p><img src="https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/C_DYJQNW0AAGSpI.jpg" alt="C_DYJQNW0AAGSpI" /></p>

<p>Êúâ‰∏ÄÊÆµÊù•Ëá™ Manifold Inc. ÁöÑÂæàÊúâÊÑèÊÄùÁöÑ python ‰ª£Á†ÅÂ∞±ÊòØÊ®°ÊãüËøô‰∏™ÊÉÖÂÜµÁöÑÔºö</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""
Short description - This module simulates a 10 armed bandit problem using a simple tabular actioin-value method
:copyright: 2018 Manifold Inc.
:author: Rajendra Koppula &lt;rkoppula@manifold.ai&gt;
"""</span>
<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">import</span> <span class="nn">gym_bandits</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span><span class="p">,</span> <span class="n">find_dotenv</span>
<span class="kn">from</span> <span class="nn">src.visualization.visualize</span> <span class="kn">import</span> <span class="n">plot_rewards</span><span class="p">,</span> <span class="n">plot_actions</span>

<span class="n">N_STEPS_PER_PLAY</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="k">class</span> <span class="nc">Agent</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">start_epsilon</span><span class="p">,</span> <span class="n">end_epsilon</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">start_epsilon</span> <span class="o">=</span> <span class="n">start_epsilon</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">end_epsilon</span> <span class="o">=</span> <span class="n">end_epsilon</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">get_greedy_action</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">"a"</span><span class="p">).</span><span class="n">mean</span><span class="p">()[</span><span class="s">"r"</span><span class="p">]</span>
            <span class="c1"># Some actions may not have been taken so far. Reindex to add them to the mix
</span>            <span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span><span class="p">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="c1"># If there are multiple actions with values equal to maximum, random sample one
</span>            <span class="n">maxs</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="n">Q</span><span class="o">==</span><span class="n">Q</span><span class="p">.</span><span class="nb">max</span><span class="p">()]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">maxs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">maxs</span><span class="p">.</span><span class="n">sample</span><span class="p">().</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Q</span><span class="p">.</span><span class="n">idxmax</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If empty, choose a random action
</span>            <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">):</span>
        <span class="c1"># Action, reward and epsilon for each step
</span>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="s">"e"</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">))</span>
        <span class="n">df</span><span class="p">[</span><span class="s">'a'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># Setup up epsilon decay
</span>        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">end_epsilon</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># No decay
</span>            <span class="n">df</span><span class="p">[</span><span class="s">"e"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">start_epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">start_epsilon</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s">"e"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">start_epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">end_epsilon</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>

        <span class="c1"># Run for n_steps
</span>        <span class="c1"># At each step, make a decision to take a random action or a greedy action
</span>        <span class="c1"># Greedy =&gt; select the action with the highest estimate of the Expected return
</span>        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="s">"e"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># greedy policy
</span>                <span class="c1"># use history upto step-1
</span>                <span class="n">action</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">.</span><span class="n">get_greedy_action</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># epsilon-greedy policy
</span>                <span class="n">e_sample</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">e_sample</span> <span class="o">&lt;=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="s">"e"</span><span class="p">]:</span>
                    <span class="c1"># Explore by taking a random action
</span>                    <span class="n">action</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Exploit current knowledge about the system
</span>                    <span class="n">action</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">.</span><span class="n">get_greedy_action</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">_</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="s">"r"</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
            <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="s">"a"</span><span class="p">]</span> <span class="o">=</span> <span class="n">action</span>

        <span class="k">return</span> <span class="n">df</span>


<span class="k">def</span> <span class="nf">play_wrapper</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">agent</span><span class="p">):</span>
    <span class="n">avg_r_col</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s">' avg reward'</span>
    <span class="n">action_col</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s">" action"</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">avg_r_col</span><span class="p">,</span> <span class="n">action_col</span><span class="p">]</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS_PER_PLAY</span><span class="p">)</span>
    <span class="c1"># Compute average reward recieved up until every step
</span>    <span class="n">df</span><span class="p">[</span><span class="n">avg_r_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">r</span><span class="p">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">"a"</span><span class="p">:</span><span class="n">action_col</span><span class="p">})</span>
    <span class="c1"># df = df[columns]
</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="s">"BanditTenArmedGaussian-v0"</span><span class="p">)</span>
    <span class="n">env</span><span class="p">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="c1"># epsilon = 0 =&gt; No exploration, always greedy
</span>    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Training greedy agent"</span><span class="p">)</span>
    <span class="n">g_df</span> <span class="o">=</span> <span class="n">play_wrapper</span><span class="p">(</span><span class="s">'greedy agent'</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">agent</span><span class="p">)</span>

    <span class="c1"># Note: Since the steps are IID in 10-armed bandit, we continue to use the same env without resetting it This allows
</span>    <span class="c1"># us to evaluate different agents consistently on the same problem.  Resetting env would change the true mean
</span>    <span class="c1"># returns for each action. In this case, to properly evaluate we would need to average across many plays for each
</span>    <span class="c1"># agent to compare them.
</span>    <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Training epsilon-greedy agent"</span><span class="p">)</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">epsilon_g_df</span> <span class="o">=</span> <span class="n">play_wrapper</span><span class="p">(</span><span class="s">'epsilon-greedy agent'</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">agent</span><span class="p">)</span>

    <span class="c1"># decaying epsilon
</span>    <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Training decaying epsilon-greedy agent"</span><span class="p">)</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="n">decaying_epsilon_g_df</span> <span class="o">=</span> <span class="n">play_wrapper</span><span class="p">(</span><span class="s">'decaying epsilon-greedy agent'</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">agent</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">g_df</span><span class="p">,</span> <span class="n">epsilon_g_df</span><span class="p">,</span> <span class="n">decaying_epsilon_g_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">rewards_plot_filename</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'PROJECT_DIR'</span><span class="p">],</span> <span class="s">"reports/figures/10_armed_agents_rewards.html"</span><span class="p">)</span>
    <span class="n">plot_rewards</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">rewards_plot_filename</span><span class="p">)</span>

    <span class="n">actions_plot_filename</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'PROJECT_DIR'</span><span class="p">],</span> <span class="s">"reports/figures/10_armed_agents_actions.html"</span><span class="p">)</span>
    <span class="n">plot_actions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">actions_plot_filename</span><span class="p">)</span>
</code></pre></div></div>

<p>Âú®Ëøô‰∏™ÁöÑÊµãËØï‰∏ãÔºå‰ªñ‰ª¨ÂæóÂà∞‰∫ÜËøôÊ†∑ÁöÑÁªìÊûúÔºö</p>

<p><img src="https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/rewards1.png" alt="rewards1" /></p>

<p>Âú®Êé®ËçêÁÆóÊ≥ï‰∏≠ÔºåÁ¨¨‰∏Ä‰∏™ E ‰ª£Ë°® ExploreÔºå‰πüÂ∞±ÊòØÊé¢Á¥¢Áî®Êà∑Êñ∞ÂÖ¥Ë∂£ÔºåÊâ©Â±ïÁî®Êà∑ËÆ§Áü•ÔºõÁ¨¨‰∫å‰∏™ E ‰ª£Ë°® ExploitÔºå‰πüÂ∞±ÊòØÈÄöËøáÂ∑≤ÊúâÁöÑÁî®Êà∑ÁîªÂÉèÂà©Áî®„ÄÅÂºÄÂèëÁî®Êà∑ÁöÑÊó∂Èó¥„ÄÅÈáëÈí±„ÄÇ</p>

<p>Á¨¨‰∏Ä‰∏™ E Ë∂äÂ§ßÔºåÂàôÁü≠ÊúüÊî∂ÁõäË∂ä‰ΩéÔºåÈïøÊúü‰ΩìÈ™åÊõ¥Â•ΩÔºõÁ¨¨‰∫å‰∏™ E Ë∂äÂ§ßÔºåÂàôÁü≠ÊúüÊî∂ÁõäË∂äÈ´òÔºåËåßÊàøÊïàÂ∫îË∂äÂº∫„ÄÇÁåúÁåúËµÑÊú¨ÈÄâÊã©‰∫ÜÂì™‰∏™Ôºü‚Äî‚ÄîÂú®ÂûÑÊñ≠„ÄÅÁ´û‰∫âÁöÑÂéãÂäõ„ÄÅË°å‰∏öÂ∑®Â§¥ÁöÑËßÑÂàô‰∏ãÔºåÂè™ËÉΩÁ´≠Â∞ΩÂÖ®ÂäõÂú∞ÊèêÈ´òÁ¨¨‰∫å‰∏™ EÔºåÁ¨¨‰∏Ä‰∏™ E Ê≤¶‰∏∫‰∫ÜÂÅöÁªôÂ∏ÇÂú∫„ÄÅÊäïËµÑÊñπÁúãÁöÑÈÅìÂÖ∑„ÄÇ</p>

<p>ÊâÄ‰ª•ÔºåÂπ≥Âè∞Âπ∂‰∏çÊÉ≥ÊëíÂºÉ‰ø°ÊÅØËåßÊàø„ÄÇÂæàÂ§öÂπ≥Âè∞Âú®‰∏çËÆ∫ÊîøÂ∫úËøòÊòØÊäïËµÑÊñπÁöÑÂéãËø´‰∏ãÔºåÂ∞ùËØïÊâ≠ËΩ¨Ëøô‰∏ÄÂ±ÄÈù¢Ôºå‰ΩÜÁî®Êà∑Êï∞Èáè‰ºóÂ§ö‰∏îË∞ÉÊï¥ÈöæÂ∫¶Â§ßÔºåÊâìÁ†¥‰ø°ÊÅØËåßÊàøÁöÑÂ∞ùËØïÂ∞±ÈõÜ‰∏≠Âú®‰ø°ÊÅØ‰æõÁªôÊñπ‚Äî‚ÄîÂ™í‰Ωì‰∏éÂπ≥Âè∞ÔºåÂ∞§ÂÖ∂ÈõÜ‰∏≠‰∫éÂπ≥Âè∞ÁÆóÊ≥ïÊú∫Âà∂ÊñπÈù¢ÔºåÂπ≥Âè∞ÁÆóÊ≥ïÁöÑ‰ºòÂåñÔºåÂè™ÊòØÂáèËΩª‰ø°ÊÅØËåßÊàøÔºåÂπ≥Ë°°‰ø°ÊÅØËåßÊàøÁöÑÂõ†‰∏éÊûúÔºåÊó†Ê≥ïÊ∂àÁÅ≠‰ø°ÊÅØËåßÊàø„ÄÇ</p>
    <hr />
      <h2 id="ÊúâÁî®ÁöÑÈìæÊé•">
        
        
          <a href="#ÊúâÁî®ÁöÑÈìæÊé•" class="anchor-head"></a> ÊúâÁî®ÁöÑÈìæÊé•
        
        
      </h2>

<p><a href="ttps://www.cnblogs.com/xiachongkun/p/7719235.html">Âº∫ÂåñÂ≠¶‰π†ÊÄªÁªìÔºà1Ôºâ‚ÄìEE ÈóÆÈ¢ò</a>
<a href="https://github.com/manifoldai/reinforcement_learning_public/blob/master/src/models/k_armed_bandit.py">manifold ‰ª£Á†Å</a>
<a href="https://www.manifold.ai/exploration-vs-exploitation-in-reinforcement-learning">manifold ÊñáÁ´†</a></p>
 
					</div>
				</article>

				
			</main>

			  <nav class="post-nav">
  
  <a
    class="post-nav-item post-nav-prev"
    href="/winter-memo/"
  >
    <div class="nav-arrow">Previous</div>
    <span class="post-title">‚úèÔ∏è ÂÜ¨‚Äî‚ÄîÈöèÁ¨î</span>
  </a>
   
  <a class="post-nav-item post-nav-next" href="/the-eyeless/">
    <div class="nav-arrow">Next</div>
    <span class="post-title">üìï The Eyeless.</span>
  </a>
  
</nav>
  <footer class="footer">
	<a class="footer_item" href="/thanks">ack.</a>
	<a class="footer_item" href="javascript::void(0)">resume</a>
	<a class="footer_item" href="/feed.xml">rss</a>
	<span class="footer_item">&copy; 2023</span>
	<small class="footer_copyright">
		<!-- Klis√© Theme: https://github.com/piharpi/jekyll-klise -->
		modified upon
		<a
			href="https://github.com/piharpi/jekyll-klise"
			target="_blank"
			rel="noreferrer noopener"
			>klis√©</a
		>
		theme, powered by
		<a href="https://vercel.com" target="_blank" rel="nonreferrer noopener"
			>Vercel</a
		>
	</small>
</footer>
<script src="/assets/js/main.js" defer="defer"></script>
		</div>
	</body>
</html>
