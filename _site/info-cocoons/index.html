<!DOCTYPE html>
<html lang="en-UK">
	<head prefix="og: http://ogp.me/ns#">
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="application-name" content="KnowsCount's Blog" />
	<meta name="apple-mobile-web-app-status-bar-style" content="#fff" />
	<meta name="apple-mobile-web-app-title" content="KnowsCount's Blog" />
	<title>
		ğŸ–² ä»€ä¹ˆæ˜¯ä¿¡æ¯èŒ§æˆ¿ - KnowsCount's Blog
	</title>
	<link
		rel="alternate"
		href="http://localhost:4000/info-cocoons/"
		hreflang="en-UK"
	/>
	<link
		rel="canonical"
		href="http://localhost:4000/info-cocoons/"
	/>
	 
	<meta
		name="description"
		content="I am a poet."
	/>
	<meta name="referrer" content="no-referrer-when-downgrade" />
	<meta property="fb:app_id" content="" />
	<meta
		property="og:site_name"
		content="ğŸ–² ä»€ä¹ˆæ˜¯ä¿¡æ¯èŒ§æˆ¿ | KnowsCount"
	/>
	<meta
		property="og:title"
		content="ğŸ–² ä»€ä¹ˆæ˜¯ä¿¡æ¯èŒ§æˆ¿ | KnowsCount"
	/>
	
	<meta property="og:type" content="website" />
	
	<meta
		property="og:url"
		content="http://localhost:4000/info-cocoons/"
	/>
	<meta
		property="og:description"
		content="I am a poet."
	/>
	
	<meta property="og:image" content="http://localhost:4000/assets/img/ogp.png" />
	
	<meta property="og:image:width" content="640" />
	<meta property="og:image:height" content="640" />
	<meta name="twitter:card" content="summary" />
	<meta
		name="twitter:title"
		content="ğŸ–² ä»€ä¹ˆæ˜¯ä¿¡æ¯èŒ§æˆ¿ | knowscount"
	/>
	<meta
		name="twitter:url"
		content="http://localhost:4000/info-cocoons/"
	/>
	<meta name="twitter:site" content="@knowscount" />
	<meta name="twitter:creator" content="@knowscount" />
	<meta
		name="twitter:description"
		content="I am a poet."
	/>
	
	<meta name="twitter:image" content="http://localhost:4000/assets/img/ogp.png" />
	 <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="KnowsCount&apos;s Blog" />
	<link
		rel="apple-touch-icon"
		sizes="180x180"
		href="/assets/favicons/apple-touch-icon.png"
	/>
	<link
		rel="icon"
		type="image/png"
		sizes="32x32"
		href="/assets/favicons/favicon-32x32.png"
	/>
	<link
		rel="icon"
		type="image/png"
		sizes="16x16"
		href="/assets/favicons/favicon-16x16.png"
	/>
	<link rel="manifest" href="/assets/favicons/site.webmanifest" />
	<link
		rel="mask-icon"
		href="/assets/favicons/safari-pinned-tab.svg"
		color="#5bbad5"
	/>
	<meta name="apple-mobile-web-app-title" content="Jekyll Klise" />
	<meta name="application-name" content="Jekyll Klise" />
	<meta name="msapplication-TileColor" content="#da532c" />
	<meta name="theme-color" content="#2c2c2c" />

	<link rel="stylesheet" href="/assets/css/style.css" />
	<meta
		name="google-site-verification"
		content="tYpcDp6dpktMEzRmAyRbJXydqOBuCTzV3AeDFHuE60M"
	/>
</head>

	<body data-theme="light" class="notransition">
		<script
			async
			src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"
		></script>
		<script>
			const body = document.body
			const data = body.getAttribute('data-theme')

			const initTheme = (state) => {
				if (state === 'dark') {
					body.setAttribute('data-theme', 'dark')
				} else if (state === 'light') {
					body.removeAttribute('data-theme')
				} else {
					localStorage.setItem('theme', data)
				}
			}

			initTheme(localStorage.getItem('theme'))

			setTimeout(() => body.classList.remove('notransition'), 75)
		</script>

		<div class="navbar" role="navigation">
  <nav class="menu">
    <input type="checkbox" id="menu-trigger" class="menu-trigger" />
    <label for="menu-trigger">
      <span class="menu-icon">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <path
            d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"
          />
        </svg>
      </span>
    </label>
    <a id="mode">
      <svg
        class="mode-sunny"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 512 512"
      >
        <title>LIGHT</title>
        <line
          x1="256"
          y1="48"
          x2="256"
          y2="96"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="256"
          y1="416"
          x2="256"
          y2="464"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="108.92"
          x2="369.14"
          y2="142.86"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="369.14"
          x2="108.92"
          y2="403.08"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="464"
          y1="256"
          x2="416"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="96"
          y1="256"
          x2="48"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="403.08"
          x2="369.14"
          y2="369.14"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="142.86"
          x2="108.92"
          y2="108.92"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <circle
          cx="256"
          cy="256"
          r="80"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
      </svg>
      <svg
        class="mode-moon"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 512 512"
      >
        <title>DARK</title>
        <line
          x1="256"
          y1="48"
          x2="256"
          y2="96"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="256"
          y1="416"
          x2="256"
          y2="464"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="108.92"
          x2="369.14"
          y2="142.86"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="369.14"
          x2="108.92"
          y2="403.08"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="464"
          y1="256"
          x2="416"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="96"
          y1="256"
          x2="48"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="403.08"
          x2="369.14"
          y2="369.14"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="142.86"
          x2="108.92"
          y2="108.92"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <circle
          cx="256"
          cy="256"
          r="80"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
      </svg>
    </a>
    <div class="trigger">
      <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/reflections/">reflections</a><a class="menu-link" href="/about/">about</a><a class="menu-link rss" href="/feed.xml">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="17"
            height="17"
            viewBox="0 0 512 512"
            fill="#ED812E"
          >
            <title>RSS</title>
            <path
              d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"
            />
            <path
              d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"
            />
            <path
              d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"
            />
          </svg>
        </a>
      </div>
    </div>
  </nav>
</div>

		<div class="wrapper post">
			<main class="page-content" aria-label="Content">
				<article itemscope itemtype="https://schema.org/BlogPosting">
					<header class="header">
						
						<div class="tags">
							
							<span itemprop="keywords">
								
								<a
									class="tag"
									href="/tags/#blog"
									>BLOG</a
								> 
							</span>
						</div>
						
						<h1 class="header-title" itemprop="headline">
							ğŸ–² ä»€ä¹ˆæ˜¯ä¿¡æ¯èŒ§æˆ¿
						</h1>
						
						<div class="post-meta">
							<time
								datetime="2021-01-15T00:00:00+00:00"
								itemprop="datePublished"
							>
								Jan 15, 2021
							</time>
							&nbsp;
							<span
								itemprop="author"
								itemscope
								itemtype="https://schema.org/Person"
							>
								<span itemprop="name"
									>KnowsCount</span
								>
							</span>
							<span>|</span>
							<span id="busuanzi_container_page_pv"
								>viewed:
								<span id="busuanzi_value_page_pv"></span>
								times</span
							>
							<time
								hidden
								datetime=""
								itemprop="dateModified"
							>
								Jan 15, 2021
							</time>
							<span hidden itemprop="publisher" itemtype="Person"
								>KnowsCount</span
							>
							<span hidden itemprop="image"
								></span
							>
							<span hidden itemprop="mainEntityOfPage"
								><h2 id="å½“ä»Šæˆ‘ä»¬æ´»åœ¨ä¸€ä¸ªç®—æ³•ç»Ÿæ²»çš„äº’è”ç½‘é‡Œ">å½“ä»Šï¼Œæˆ‘ä»¬æ´»åœ¨ä¸€ä¸ªç®—æ³•ç»Ÿæ²»çš„äº’è”ç½‘é‡Œã€‚</h2>
</span
							>
						</div>
						
					</header>

					<div class="page-content" itemprop="articleBody">
						<h2 id="å½“ä»Šæˆ‘ä»¬æ´»åœ¨ä¸€ä¸ªç®—æ³•ç»Ÿæ²»çš„äº’è”ç½‘é‡Œ">
        
        
          <a href="#å½“ä»Šæˆ‘ä»¬æ´»åœ¨ä¸€ä¸ªç®—æ³•ç»Ÿæ²»çš„äº’è”ç½‘é‡Œ" class="anchor-head"></a> å½“ä»Šï¼Œæˆ‘ä»¬æ´»åœ¨ä¸€ä¸ªç®—æ³•ç»Ÿæ²»çš„äº’è”ç½‘é‡Œã€‚
        
        
      </h2>

<p>AI ç­ç»äººç±»ï¼Œè¿˜å¤ªé¥è¿œï¼›AI ä¸»å®°äººç±»ï¼Œä¸šå·²å¼€å§‹ã€‚</p>
    <hr />

<p>æ ‡é¢˜è¯´ï¼Œé€ƒç¦»ä¿¡æ¯èŒ§æˆ¿ï¼Œå¯ä¿¡æ¯èŒ§æˆ¿æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <h3 id="ä¿¡æ¯æ¶ˆè´¹ä¸ªäººåŒ–">
        
        
          <a href="#ä¿¡æ¯æ¶ˆè´¹ä¸ªäººåŒ–" class="anchor-head"></a> ä¿¡æ¯æ¶ˆè´¹ä¸ªäººåŒ–
        
        
      </h3>

<p>ç°åœ¨å„å¤§å†…å®¹å¹³å°èƒŒåéƒ½æœ‰å¼ºå¤§çš„ç®—æ³•æ”¯æ’‘ï¼Œä»¥å¸¦ç»™åœ¨åº§è¯¸ä½ä»–ä»¬æƒ³è¦çœ‹åˆ°çš„å†…å®¹ã€‚å¬èµ·æ¥å¾ˆå¥½ï¼Œä¸æ˜¯ä¹ˆï¼Ÿâ€”â€”ä½†æ˜¯ï¼Œåœ¨è¿™åŒæ—¶ï¼Œä»–ä»¬çš„ç¬¬ä¸€ç›®çš„å…¶å®æ˜¯è®©ä½¿ç”¨è€…å°½å¯èƒ½åœ°æ¶ˆè´¹æ›´å¤šä¸œè¥¿ï¼šå†…å®¹ã€å•†å“ã€æ—¶é—´ï¼Œå› è€Œæé«˜å…¶æµé‡æ”¶ç›Šã€‚</p>

<p>åœ¨æˆ‘ä»¬æŸå®æ—¶ï¼Œé¦–é¡µåŸºæœ¬æ˜¯å‰ä¸€æ¬¡æœç´¢ç‰©å“çš„åŒæ¬¾ï¼›åœ¨æˆ‘ä»¬æŸä¹æ—¶ï¼Œæœç´¢æˆ–è€…ç‚¹èµã€è¯„è®ºã€æ”¶è—äº†æŸå†…å®¹ï¼Œæ¥ä¸‹æ¥ä¼šè¶Šæ¥è¶Šå¤šæ¨èç›¸ä¼¼çš„å†…å®¹ï¼›åœ¨æˆ‘ä»¬æŠ– y æ—¶ï¼Œçœ‹åˆ°çš„æ–°å†…å®¹æœ¬è´¨éƒ½æ˜¯ç›¸ä¼¼çš„ï¼›</p>

<p><img src="https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/facebook.jpeg" alt="facebook" /></p>

<p>æ‰€ä»¥ï¼Œä½ å¯ä»¥ä¸ºè‡ªå·±æ‰“é€ ä¸€ä»½ã€Œä¸ªäººæ—¥æŠ¥ã€ã€‚æš‚ä¸”ä¸ææ€–å§ï¼Ÿæ˜¯çš„ï¼Œè¿˜ä¸ææ€–ã€‚</p>
    
      <h3 id="æ¶ˆè´¹å†…å®¹é‡å¤åŒ–">
        
        
          <a href="#æ¶ˆè´¹å†…å®¹é‡å¤åŒ–" class="anchor-head"></a> æ¶ˆè´¹å†…å®¹é‡å¤åŒ–
        
        
      </h3>

<p>ä¸è¿‡ï¼Œè¿™åœ¨æ»¡è¶³ä½ çš„å¤§è„‘åé¦ˆæœºåˆ¶çš„åŒæ—¶ï¼Œè¿™ç§ä»¥ç”¨æˆ·ç”»åƒå®ç°çš„ä¸ªæ€§åŒ–ä¹Ÿä¼šç¼–ç»‡ä¸€ä¸ªã€Œä¿¡æ¯èŒ§æˆ¿ã€â€”â€”å†…å®¹çš„åŒè´¨åŒ–ã€‚æ›´è¯¦ç»†ä¸€äº›ï¼š</p>

<blockquote>
  <p>ä¿¡æ¯èŒ§æˆ¿æ˜¯æŒ‡äººä»¬å…³æ³¨çš„ä¿¡æ¯é¢†åŸŸä¼šä¹ æƒ¯æ€§åœ°è¢«è‡ªå·±çš„å…´è¶£æ‰€å¼•å¯¼ï¼Œä»è€Œå°†è‡ªå·±çš„ç”Ÿæ´»æ¡æ¢äºåƒèš•èŒ§ä¸€èˆ¬çš„â€œèŒ§æˆ¿â€ä¸­çš„ç°è±¡ã€‚ ç”±äºä¿¡æ¯æŠ€æœ¯æä¾›äº†æ›´è‡ªæˆ‘çš„æ€æƒ³ç©ºé—´å’Œä»»ä½•é¢†åŸŸçš„å·¨é‡çŸ¥è¯†ï¼Œä¸€äº›äººè¿˜å¯èƒ½è¿›ä¸€æ­¥é€ƒé¿ç¤¾ä¼šä¸­çš„ç§ç§çŸ›ç›¾ï¼Œæˆä¸ºä¸ä¸–éš”ç»çš„å­¤ç«‹è€…ã€‚</p>
</blockquote>

<p>äººä»¬æ›´æ„¿æ„æ¥è§¦è‡ªå·±æ„Ÿå…´è¶£çš„å†…å®¹ï¼Œè¿™å—äººçš„å¤©æ€§æˆ–è€…è¯´æ€æƒ³æƒ°æ€§çš„åˆ¶çº¦ï¼Œè€ŒæŠ€æœ¯å…¬å¸å°±æ˜¯åˆ©ç”¨äº†è¿™æ ·çš„å¼±ç‚¹ï¼Œäºæ— å½¢ä¹‹ä¸­è¯±å¯¼ä½ è¿›å…¥ä¿¡æ¯å¯†é—­çš„ç©ºé—´ï¼ŒæŠŠä½ å›°åœ¨ä¸€æ ·çš„å£°éŸ³é‡Œï¼Œä¸çœŸæ­£çš„ç¤¾ä¼šè„±é’©ã€‚æ€ä¹ˆæ ·ï¼Œææ€–äº†ä¹ˆï¼Ÿ</p>
    
      <h3 id="æ¶ˆè´¹ç¾¤ä½“å‰²è£‚åŒ–">
        
        
          <a href="#æ¶ˆè´¹ç¾¤ä½“å‰²è£‚åŒ–" class="anchor-head"></a> æ¶ˆè´¹ç¾¤ä½“å‰²è£‚åŒ–
        
        
      </h3>

<p>è¿™ä¼šé€ æˆä»€ä¹ˆï¼Ÿâ€”â€”ç½‘ç»œç©ºé—´å·´å°”å¹²åŒ–ï¼ŒæŠŠæ‰€æœ‰äººåˆ†è£‚æˆæœ‰ç€ä¸åŒåˆ©ç›Šç›®æ ‡ã€ä»·å€¼ä¿¡ä»°ã€å…´è¶£å–å‘çš„ç¹å¤šç¾¤ç±»ï¼Œå¹¶å°†æ‰€æœ‰äººå›°åœ¨è‡ªå·±çš„èŒ§æˆ¿é‡Œã€‚</p>
    <hr />

<p>æ ‡é¢˜åˆè¯´ï¼Œã€Œé€ƒç¦»ã€ä¿¡æ¯èŒ§æˆ¿ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦é€ƒç¦»ï¼Ÿè¦æ€ä¹ˆé€ƒï¼Ÿ</p>
      <h3 id="ä¸ºä»€ä¹ˆ">
        
        
          <a href="#ä¸ºä»€ä¹ˆ" class="anchor-head"></a> ä¸ºä»€ä¹ˆï¼Ÿ
        
        
      </h3>

<p>ä¿¡æ¯èŒ§æˆ¿èƒ½ç»™ä¸–ç•Œå¸¦æ¥æ— å°½çš„ä¼¤å®³ï¼Œéšä¾¿ä¸¾å‡ ä¸ªä¾‹å­ï¼š</p>

<p><em>ä¸ªäººè®¤çŸ¥çª„åŒ–ã€æ—ç¾¤æåŒ–ã€è™šå‡ä¿¡æ¯æ³›æ»¥ã€å½±å“ç¤¾ä¼šç¨³å®šâ€¦â€¦</em></p>
    
      <h3 id="å¹³å°ç®—æ³•çš„ä¼˜åŒ–">
        
        
          <a href="#å¹³å°ç®—æ³•çš„ä¼˜åŒ–" class="anchor-head"></a> å¹³å°ç®—æ³•çš„ä¼˜åŒ–
        
        
      </h3>

<p>åœ¨ç®—æ³•ç†è®ºä¸­ï¼Œæœ‰ä¸€ä¸ª EE é—®é¢˜ï¼ˆExploration and Exploitation tradeoffï¼‰ï¼Œç›´æ¥è¯‘è¿‡æ¥å°±æ˜¯ã€Œæ¢ç´¢-åˆ©ç”¨ã€é—®é¢˜ã€‚</p>

<p><img src="https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/C_DYJQNW0AAGSpI.jpg" alt="C_DYJQNW0AAGSpI" /></p>

<p>æœ‰ä¸€æ®µæ¥è‡ª Manifold Inc. çš„å¾ˆæœ‰æ„æ€çš„ python ä»£ç å°±æ˜¯æ¨¡æ‹Ÿè¿™ä¸ªæƒ…å†µçš„ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"""
Short description - This module simulates a 10 armed bandit problem using a simple tabular actioin-value method
:copyright: 2018 Manifold Inc.
:author: Rajendra Koppula &lt;rkoppula@manifold.ai&gt;
"""</span>
<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">import</span> <span class="nn">gym_bandits</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span><span class="p">,</span> <span class="n">find_dotenv</span>
<span class="kn">from</span> <span class="nn">src.visualization.visualize</span> <span class="kn">import</span> <span class="n">plot_rewards</span><span class="p">,</span> <span class="n">plot_actions</span>

<span class="n">N_STEPS_PER_PLAY</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="k">class</span> <span class="nc">Agent</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">start_epsilon</span><span class="p">,</span> <span class="n">end_epsilon</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">start_epsilon</span> <span class="o">=</span> <span class="n">start_epsilon</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">end_epsilon</span> <span class="o">=</span> <span class="n">end_epsilon</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">get_greedy_action</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">"a"</span><span class="p">).</span><span class="n">mean</span><span class="p">()[</span><span class="s">"r"</span><span class="p">]</span>
            <span class="c1"># Some actions may not have been taken so far. Reindex to add them to the mix
</span>            <span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span><span class="p">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="c1"># If there are multiple actions with values equal to maximum, random sample one
</span>            <span class="n">maxs</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="n">Q</span><span class="o">==</span><span class="n">Q</span><span class="p">.</span><span class="nb">max</span><span class="p">()]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">maxs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">maxs</span><span class="p">.</span><span class="n">sample</span><span class="p">().</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Q</span><span class="p">.</span><span class="n">idxmax</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If empty, choose a random action
</span>            <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">):</span>
        <span class="c1"># Action, reward and epsilon for each step
</span>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="s">"e"</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">))</span>
        <span class="n">df</span><span class="p">[</span><span class="s">'a'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="c1"># Setup up epsilon decay
</span>        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">end_epsilon</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># No decay
</span>            <span class="n">df</span><span class="p">[</span><span class="s">"e"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">start_epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">start_epsilon</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="s">"e"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">start_epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">end_epsilon</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>

        <span class="c1"># Run for n_steps
</span>        <span class="c1"># At each step, make a decision to take a random action or a greedy action
</span>        <span class="c1"># Greedy =&gt; select the action with the highest estimate of the Expected return
</span>        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="s">"e"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># greedy policy
</span>                <span class="c1"># use history upto step-1
</span>                <span class="n">action</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">.</span><span class="n">get_greedy_action</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># epsilon-greedy policy
</span>                <span class="n">e_sample</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">e_sample</span> <span class="o">&lt;=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="s">"e"</span><span class="p">]:</span>
                    <span class="c1"># Explore by taking a random action
</span>                    <span class="n">action</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Exploit current knowledge about the system
</span>                    <span class="n">action</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">.</span><span class="n">get_greedy_action</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">_</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="s">"r"</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
            <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span> <span class="s">"a"</span><span class="p">]</span> <span class="o">=</span> <span class="n">action</span>

        <span class="k">return</span> <span class="n">df</span>


<span class="k">def</span> <span class="nf">play_wrapper</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">agent</span><span class="p">):</span>
    <span class="n">avg_r_col</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s">' avg reward'</span>
    <span class="n">action_col</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s">" action"</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">avg_r_col</span><span class="p">,</span> <span class="n">action_col</span><span class="p">]</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">agent</span><span class="p">.</span><span class="n">play</span><span class="p">(</span><span class="n">n_steps</span><span class="o">=</span><span class="n">N_STEPS_PER_PLAY</span><span class="p">)</span>
    <span class="c1"># Compute average reward recieved up until every step
</span>    <span class="n">df</span><span class="p">[</span><span class="n">avg_r_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">r</span><span class="p">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">"a"</span><span class="p">:</span><span class="n">action_col</span><span class="p">})</span>
    <span class="c1"># df = df[columns]
</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="s">"BanditTenArmedGaussian-v0"</span><span class="p">)</span>
    <span class="n">env</span><span class="p">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="c1"># epsilon = 0 =&gt; No exploration, always greedy
</span>    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Training greedy agent"</span><span class="p">)</span>
    <span class="n">g_df</span> <span class="o">=</span> <span class="n">play_wrapper</span><span class="p">(</span><span class="s">'greedy agent'</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">agent</span><span class="p">)</span>

    <span class="c1"># Note: Since the steps are IID in 10-armed bandit, we continue to use the same env without resetting it This allows
</span>    <span class="c1"># us to evaluate different agents consistently on the same problem.  Resetting env would change the true mean
</span>    <span class="c1"># returns for each action. In this case, to properly evaluate we would need to average across many plays for each
</span>    <span class="c1"># agent to compare them.
</span>    <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Training epsilon-greedy agent"</span><span class="p">)</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">epsilon_g_df</span> <span class="o">=</span> <span class="n">play_wrapper</span><span class="p">(</span><span class="s">'epsilon-greedy agent'</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">agent</span><span class="p">)</span>

    <span class="c1"># decaying epsilon
</span>    <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Training decaying epsilon-greedy agent"</span><span class="p">)</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="n">decaying_epsilon_g_df</span> <span class="o">=</span> <span class="n">play_wrapper</span><span class="p">(</span><span class="s">'decaying epsilon-greedy agent'</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">agent</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">g_df</span><span class="p">,</span> <span class="n">epsilon_g_df</span><span class="p">,</span> <span class="n">decaying_epsilon_g_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">rewards_plot_filename</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'PROJECT_DIR'</span><span class="p">],</span> <span class="s">"reports/figures/10_armed_agents_rewards.html"</span><span class="p">)</span>
    <span class="n">plot_rewards</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">rewards_plot_filename</span><span class="p">)</span>

    <span class="n">actions_plot_filename</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'PROJECT_DIR'</span><span class="p">],</span> <span class="s">"reports/figures/10_armed_agents_actions.html"</span><span class="p">)</span>
    <span class="n">plot_actions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">actions_plot_filename</span><span class="p">)</span>
</code></pre></div></div>

<p>åœ¨è¿™ä¸ªçš„æµ‹è¯•ä¸‹ï¼Œä»–ä»¬å¾—åˆ°äº†è¿™æ ·çš„ç»“æœï¼š</p>

<p><img src="https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/rewards1.png" alt="rewards1" /></p>

<p>åœ¨æ¨èç®—æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ª E ä»£è¡¨ Exploreï¼Œä¹Ÿå°±æ˜¯æ¢ç´¢ç”¨æˆ·æ–°å…´è¶£ï¼Œæ‰©å±•ç”¨æˆ·è®¤çŸ¥ï¼›ç¬¬äºŒä¸ª E ä»£è¡¨ Exploitï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å·²æœ‰çš„ç”¨æˆ·ç”»åƒåˆ©ç”¨ã€å¼€å‘ç”¨æˆ·çš„æ—¶é—´ã€é‡‘é’±ã€‚</p>

<p>ç¬¬ä¸€ä¸ª E è¶Šå¤§ï¼Œåˆ™çŸ­æœŸæ”¶ç›Šè¶Šä½ï¼Œé•¿æœŸä½“éªŒæ›´å¥½ï¼›ç¬¬äºŒä¸ª E è¶Šå¤§ï¼Œåˆ™çŸ­æœŸæ”¶ç›Šè¶Šé«˜ï¼ŒèŒ§æˆ¿æ•ˆåº”è¶Šå¼ºã€‚çŒœçŒœèµ„æœ¬é€‰æ‹©äº†å“ªä¸ªï¼Ÿâ€”â€”åœ¨å„æ–­ã€ç«äº‰çš„å‹åŠ›ã€è¡Œä¸šå·¨å¤´çš„è§„åˆ™ä¸‹ï¼Œåªèƒ½ç«­å°½å…¨åŠ›åœ°æé«˜ç¬¬äºŒä¸ª Eï¼Œç¬¬ä¸€ä¸ª E æ²¦ä¸ºäº†åšç»™å¸‚åœºã€æŠ•èµ„æ–¹çœ‹çš„é“å…·ã€‚</p>

<p>æ‰€ä»¥ï¼Œå¹³å°å¹¶ä¸æƒ³æ‘’å¼ƒä¿¡æ¯èŒ§æˆ¿ã€‚å¾ˆå¤šå¹³å°åœ¨ä¸è®ºæ”¿åºœè¿˜æ˜¯æŠ•èµ„æ–¹çš„å‹è¿«ä¸‹ï¼Œå°è¯•æ‰­è½¬è¿™ä¸€å±€é¢ï¼Œä½†ç”¨æˆ·æ•°é‡ä¼—å¤šä¸”è°ƒæ•´éš¾åº¦å¤§ï¼Œæ‰“ç ´ä¿¡æ¯èŒ§æˆ¿çš„å°è¯•å°±é›†ä¸­åœ¨ä¿¡æ¯ä¾›ç»™æ–¹â€”â€”åª’ä½“ä¸å¹³å°ï¼Œå°¤å…¶é›†ä¸­äºå¹³å°ç®—æ³•æœºåˆ¶æ–¹é¢ï¼Œå¹³å°ç®—æ³•çš„ä¼˜åŒ–ï¼Œåªæ˜¯å‡è½»ä¿¡æ¯èŒ§æˆ¿ï¼Œå¹³è¡¡ä¿¡æ¯èŒ§æˆ¿çš„å› ä¸æœï¼Œæ— æ³•æ¶ˆç­ä¿¡æ¯èŒ§æˆ¿ã€‚</p>
    <hr />
      <h2 id="æœ‰ç”¨çš„é“¾æ¥">
        
        
          <a href="#æœ‰ç”¨çš„é“¾æ¥" class="anchor-head"></a> æœ‰ç”¨çš„é“¾æ¥
        
        
      </h2>

<p><a href="ttps://www.cnblogs.com/xiachongkun/p/7719235.html">å¼ºåŒ–å­¦ä¹ æ€»ç»“ï¼ˆ1ï¼‰â€“EE é—®é¢˜</a>
<a href="https://github.com/manifoldai/reinforcement_learning_public/blob/master/src/models/k_armed_bandit.py">manifold ä»£ç </a>
<a href="https://www.manifold.ai/exploration-vs-exploitation-in-reinforcement-learning">manifold æ–‡ç« </a></p>
 
					</div>
				</article>

				
			</main>

			  <nav class="post-nav">
  
  <a
    class="post-nav-item post-nav-prev"
    href="/winter-memo/"
  >
    <div class="nav-arrow">Previous</div>
    <span class="post-title">âœï¸ å†¬â€”â€”éšç¬”</span>
  </a>
   
  <a class="post-nav-item post-nav-next" href="/the-eyeless/">
    <div class="nav-arrow">Next</div>
    <span class="post-title">ğŸ“• The Eyeless.</span>
  </a>
  
</nav>
  <footer class="footer">
	<a class="footer_item" href="/thanks">ack.</a>
	<a class="footer_item" href="javascript::void(0)">resume</a>
	<a class="footer_item" href="/feed.xml">rss</a>
	<span class="footer_item">&copy; 2023</span>
	<small class="footer_copyright">
		<!-- KlisÃ© Theme: https://github.com/piharpi/jekyll-klise -->
		modified upon
		<a
			href="https://github.com/piharpi/jekyll-klise"
			target="_blank"
			rel="noreferrer noopener"
			>klisÃ©</a
		>
		theme, powered by
		<a href="https://vercel.com" target="_blank" rel="nonreferrer noopener"
			>Vercel</a
		>
	</small>
</footer>
<script src="/assets/js/main.js" defer="defer"></script>
		</div>
	</body>
</html>
