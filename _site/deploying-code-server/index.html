<!--
 * @Date: 19/12/2020 21.10.30 +0800
 * @Author: KnowsCount
 * @LastEditTime: 01/02/2021 23.20.31 +0800
 * @FilePath: /myBlog/_layouts/post.html
-->

<!DOCTYPE html>
<html lang="en-UK">
	<head prefix="og: http://ogp.me/ns#">
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="application-name" content="KnowsCount's Blog" />
	<meta name="apple-mobile-web-app-status-bar-style" content="#fff" />
	<meta name="apple-mobile-web-app-title" content="KnowsCount's Blog" />
	<title>
		ðŸ’» Deploying code-server - KnowsCount's Blog
	</title>
	<link
		rel="alternate"
		href="http://localhost:4000/deploying-code-server/"
		hreflang="en-UK"
	/>
	<link
		rel="canonical"
		href="http://localhost:4000/deploying-code-server/"
	/>
	 
	<meta
		name="description"
		content="I am a young front-end developer."
	/>
	<meta name="referrer" content="no-referrer-when-downgrade" />
	<meta property="fb:app_id" content="" />
	<meta
		property="og:site_name"
		content="ðŸ’» Deploying code-server | KnowsCount"
	/>
	<meta
		property="og:title"
		content="ðŸ’» Deploying code-server | KnowsCount"
	/>
	
	<meta property="og:type" content="website" />
	
	<meta
		property="og:url"
		content="http://localhost:4000/deploying-code-server/"
	/>
	<meta
		property="og:description"
		content="I am a young front-end developer."
	/>
	
	<meta property="og:image" content="http://localhost:4000/assets/img/ogp.png" />
	
	<meta property="og:image:width" content="640" />
	<meta property="og:image:height" content="640" />
	<meta name="twitter:card" content="summary" />
	<meta
		name="twitter:title"
		content="ðŸ’» Deploying code-server | knowscount"
	/>
	<meta
		name="twitter:url"
		content="http://localhost:4000/deploying-code-server/"
	/>
	<meta name="twitter:site" content="@knowscount" />
	<meta name="twitter:creator" content="@knowscount" />
	<meta
		name="twitter:description"
		content="I am a young front-end developer."
	/>
	
	<meta name="twitter:image" content="http://localhost:4000/assets/img/ogp.png" />
	 <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="KnowsCount&apos;s Blog" />
	<link
		rel="apple-touch-icon"
		sizes="180x180"
		href="/assets/favicons/apple-touch-icon.png"
	/>
	<link
		rel="icon"
		type="image/png"
		sizes="32x32"
		href="/assets/favicons/favicon-32x32.png"
	/>
	<link
		rel="icon"
		type="image/png"
		sizes="16x16"
		href="/assets/favicons/favicon-16x16.png"
	/>
	<link rel="manifest" href="/assets/favicons/site.webmanifest" />
	<link
		rel="mask-icon"
		href="/assets/favicons/safari-pinned-tab.svg"
		color="#5bbad5"
	/>
	<meta name="apple-mobile-web-app-title" content="Jekyll Klise" />
	<meta name="application-name" content="Jekyll Klise" />
	<meta name="msapplication-TileColor" content="#da532c" />
	<meta name="theme-color" content="#2c2c2c" />

	<link rel="stylesheet" href="/assets/css/style.css" />
	<meta
		name="google-site-verification"
		content="TcG_mK8pym1ZQAQWfoYDRR3ZlaRbV7tqVvrEEzA00fo"
	/>
</head>


	<body data-theme="light" class="notransition">
		<script
			async
			src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"
		></script>

		<script>
			const body = document.body
			const data = body.getAttribute('data-theme')

			const initTheme = (state) => {
				if (state === 'dark') {
					body.setAttribute('data-theme', 'dark')
				} else if (state === 'light') {
					body.removeAttribute('data-theme')
				} else {
					localStorage.setItem('theme', data)
				}
			}

			initTheme(localStorage.getItem('theme'))

			setTimeout(() => body.classList.remove('notransition'), 75)
		</script>

		<div class="navbar" role="navigation">
  <nav class="menu">
    <input type="checkbox" id="menu-trigger" class="menu-trigger" />
    <label for="menu-trigger">
      <span class="menu-icon">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <path
            d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"
          />
        </svg>
      </span>
    </label>
    <a id="mode">
      <svg
        class="mode-sunny"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 512 512"
      >
        <title>LIGHT</title>
        <line
          x1="256"
          y1="48"
          x2="256"
          y2="96"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="256"
          y1="416"
          x2="256"
          y2="464"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="108.92"
          x2="369.14"
          y2="142.86"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="369.14"
          x2="108.92"
          y2="403.08"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="464"
          y1="256"
          x2="416"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="96"
          y1="256"
          x2="48"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="403.08"
          x2="369.14"
          y2="369.14"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="142.86"
          x2="108.92"
          y2="108.92"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <circle
          cx="256"
          cy="256"
          r="80"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
      </svg>
      <svg
        class="mode-moon"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 512 512"
      >
        <title>DARK</title>
        <line
          x1="256"
          y1="48"
          x2="256"
          y2="96"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="256"
          y1="416"
          x2="256"
          y2="464"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="108.92"
          x2="369.14"
          y2="142.86"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="369.14"
          x2="108.92"
          y2="403.08"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="464"
          y1="256"
          x2="416"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="96"
          y1="256"
          x2="48"
          y2="256"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="403.08"
          y1="403.08"
          x2="369.14"
          y2="369.14"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <line
          x1="142.86"
          y1="142.86"
          x2="108.92"
          y2="108.92"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
        <circle
          cx="256"
          cy="256"
          r="80"
          style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
        />
      </svg>
    </a>
    <div class="trigger">
      <div class="trigger-container"><a class="menu-link" href="/">home</a><a class="menu-link" href="/archive/">archive</a><a class="menu-link" href="/about/">about</a><a class="menu-link rss" href="/feed.xml">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="17"
            height="17"
            viewBox="0 0 512 512"
            fill="#ED812E"
          >
            <title>RSS</title>
            <path
              d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"
            />
            <path
              d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"
            />
            <path
              d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"
            />
          </svg>
        </a>
      </div>
    </div>
  </nav>
</div>

		<div class="wrapper post">
			<main class="page-content" aria-label="Content">
				<article itemscope itemtype="https://schema.org/BlogPosting">
					<header class="header">
						
						<h1 class="header-title" itemprop="headline">
							ðŸ’» Deploying code-server
						</h1>
						
						<div class="post-meta">
							<time
								datetime="2021-07-09T00:00:00+00:00"
								itemprop="datePublished"
							>
								Jul 09, 2021
							</time>
							&nbsp;
							<span
								itemprop="author"
								itemscope
								itemtype="https://schema.org/Person"
							>
								<span itemprop="name"
									>KnowsCount</span
								>
							</span>
							<span>|</span>
							<span id="busuanzi_container_site_pv"
								>viewed:
								<span id="busuanzi_value_site_pv"></span>
								times</span
							>
							<time
								hidden
								datetime=""
								itemprop="dateModified"
							>
								Jul 09, 2021
							</time>
							<span hidden itemprop="publisher" itemtype="Person"
								>KnowsCount</span
							>
							<span hidden itemprop="image"
								></span
							>
							<span hidden itemprop="mainEntityOfPage"
								><p>some six months ago, GitHub recommended me the repository <a href="https://github.com/cdr/code-server">code-server</a>. it described itself as:</p>
</span
							>
						</div>
						
					</header>

					<div class="page-content" itemprop="articleBody">
						<p>some six months ago, GitHub recommended me the repository <a href="https://github.com/cdr/code-server">code-server</a>. it described itself as:</p>

<blockquote>
  <p>VS Code in the browser</p>
</blockquote>

<p>it seemed, in every aspect, worth a deploy; so I tried, following the documentatio, on my ubuntu 20 vps. the procedures below are also tested and evidently worked on a CentOS 7 machine. as for other operating systems, please go to <a href="https://coder.com/docs/code-server/v3.10.2/guide">the official documentation</a></p>
      <h2 id="getting-started">
        
        
          <a href="#getting-started" class="anchor-head"></a> Getting Started
        
        
      </h2>

<p>As a front-end developer, I can hardly say I know anything about servers. Therefore I dry-runned the install script lest slight mishaps:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -fsSL https://code-server.dev/install.sh | sh -s -- --dry-run
</code></pre></div></div>

<p>and everything seemed, absolutely fine to me, so I ran the install script:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -fsSL https://code-server.dev/install.sh | sh
</code></pre></div></div>

<p>the other way to do this is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tar xzvf code-server-3.4.1-linux-x86_64.tar.gz &amp;&amp; mv code-server-3.4.1-linux-x86_64 code-server
</code></pre></div></div>

<p>run, after one of the two aforementioned methods are done:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim ~/.config/code-server/config.yaml
</code></pre></div></div>

<p>entering editing mode by hitting the <code class="language-plaintext highlighter-rouge">i</code> key, change the content of the file to below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bind-addr: 0.0.0.0:{desired_port}
auth: password
password: {desired_password}
cert: false
</code></pre></div></div>

<p>now hit <code class="language-plaintext highlighter-rouge">esc</code> and enter <code class="language-plaintext highlighter-rouge">:wq</code> which will be shown in the bottom of your command line.</p>

<p>by now, everything is set up and you can simply run the programme by <code class="language-plaintext highlighter-rouge">~/code-server/bin/code-server</code>, and visiting it by entering <code class="language-plaintext highlighter-rouge">{your_ip}:{desired_port}</code> in your browser.</p>
    
      <h2 id="advanced">
        
        
          <a href="#advanced" class="anchor-head"></a> Advanced
        
        
      </h2>
    
      <h3 id="background-process">
        
        
          <a href="#background-process" class="anchor-head"></a> Background process
        
        
      </h3>

<p>create a background process file using:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim /etc/systemd/system/code-server.service
</code></pre></div></div>

<p>whereafter pasting the content below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Unit]
Description=code servier
After=network.target

[Service]
Type=simple
User=root
Restart=on-failure
RestartSec=20s
Environment=
ExecStart=/root/code-server/bin/code-server
ExecReload=/root/code-server/bin/code-server

[Install]
WantedBy=multi-user.target
</code></pre></div></div>

<p>into the file. now set this service to run on boot via the command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl enable code-server
</code></pre></div></div>

<p>more about the <code class="language-plaintext highlighter-rouge">systemctl</code> command can be found <a href="https://man7.org/linux/man-pages/man1/systemctl.1.html">here</a>.</p>
    
      <h3 id="reverse-proxy">
        
        
          <a href="#reverse-proxy" class="anchor-head"></a> Reverse Proxy
        
        
      </h3>

<p>this is the Nginx file for your reverse proxy configuration:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#PROXY-START/

  location / { # Or / if hosting at the root.
      proxy_pass http://localhost:8080/;
      proxy_set_header Host $host;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection upgrade;
      proxy_set_header Accept-Encoding gzip;
  }

#PROXY-END/
</code></pre></div></div>

<p>and this your site configuration:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>server
{
    listen 80;
    server_name {domain};
    index index.php index.html index.htm default.php default.htm default.html;
    root /www/wwwroot/{domain};
    
    #SSL-START
    #error_page 404/404.html;
    #SSL-END
    
    #ERROR-PAGE-START 
    #error_page 404 /404.html;
    #error_page 502 /502.html;
    #ERROR-PAGE-END
    
    #PHP-INFO-START
    #CLEAR-CACHE

    location ~ /purge(/.*) {
        proxy_cache_purge cache_one $host$1$is_args$args;
        #access_log  /www/wwwlogs/{domain}_purge_cache.log;
    }
	#REVERSE-PROXY
	include /www/server/panel/vhost/nginx/proxy/{domain}/*.conf;

	include enable-php-00.conf;
    #PHP-INFO-END
    
    #REWRITE-START
    include /www/server/panel/vhost/rewrite/{domain}.conf;
    #REWRITE-END
    
    location ~ ^/(\.user.ini|\.htaccess|\.git|\.svn|\.project|LICENSE|README.md)
    {
        return 404;
    }
        
    access_log  /www/wwwlogs/{domain}.log;
    error_log  /www/wwwlogs/{domain}.error.log;
}
</code></pre></div></div>
    
      <h3 id="force-https">
        
        
          <a href="#force-https" class="anchor-head"></a> Force HTTPS
        
        
      </h3>

<p><a href="https://www.cloudflare.com/">Cloudflare</a> is always a good choice.</p>
 
					</div>
				</article>

				
			</main>

			  <nav class="post-nav">
  
  <a
    class="post-nav-item post-nav-prev"
    href="/an-epigram/"
  >
    <div class="nav-arrow">Previous</div>
    <span class="post-title">ðŸ–‹ An Epigram</span>
  </a>
   
  <a class="post-nav-item post-nav-next" href="/poor-is-the-gift-of-poets/">
    <div class="nav-arrow">Next</div>
    <span class="post-title">ðŸ–‹ Poor is the Gift of Poets</span>
  </a>
  
</nav>
  <footer class="footer">
	<a class="footer_item" href="/thanks">ack.</a>
	<a class="footer_item" href="javascript::void(0)">resume</a>
	<a class="footer_item" href="/feed.xml">rss</a>
	<span class="footer_item">&copy; 2022</span>
	<small class="footer_copyright">
		<!-- KlisÃ© Theme: https://github.com/piharpi/jekyll-klise -->
		modified upon
		<a
			href="https://github.com/piharpi/jekyll-klise"
			target="_blank"
			rel="noreferrer noopener"
			>klisÃ©</a
		>
		theme, powered by
		<a href="https://vercel.com" target="_blank" rel="nonreferrer noopener"
			>Vercel</a
		>
	</small>
</footer>
<script src="/assets/js/main.js" defer="defer"></script>
		</div>
	</body>
</html>
