---
title: "\U0001F4D6 故事接龙平台的版本控制实现"
---

### 版本控制

*要怎么实现允许用户提交内容至不同故事线？*

我们准备沿用 [git](https://git-scm.com) 的思想。

![suffix}](https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/tXVfBV{/suffix})

每一个不同的故事线都是一个 `branch`，但是为了预防引发选择困难症，我们会把最先达到六个新提交的 branch 设为默认，类似区块链中的[最长链原则](https://www.jianshu.com/p/267f0572e241)。

*为啥不是 CVS、SVN 这些集中式的版本控制系统？*

~~因为 Linus 不喜欢它们。~~

引用廖雪峰老师的话：

> 版本库是集中存放在中央服务器的，而干活的时候，用的都是自己的电脑，所以要先从中央服务器取得最新的版本，然后开始干活，干完活了，再把自己的活推送给中央服务器。中央服务器就好比是一个图书馆，你要改一本书，必须先从图书馆借出来，然后回到家自己改，改完了，再放回图书馆。

这意味着甚么？——**你必须要联网，才能工作。**你提交代码时的爽与不爽，还得看网速的脸色。

![suffix}](https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/xotvXZ{/suffix})

当然，有些地方 git 也不完全适合我们的平台，所以我们准备**把 git 融入区块链**。

---

*把 git 融入区块链？会有哪些难点？*

主要的难点在于 git 版本控制的分布式与区块链的分布式还是有比较大的区别的。

- Git: 

    > 相当于其分布式的核心是除了中心服务器，自己的电脑本身也保存了仓库的整个拷贝，即使在不联网的情况下也可以完成版本的工作和更新。

所以，git 的分布式是‘**中心化下的分布式**’。

- 区块链：

    > 区块链的分布式就要严格的多，以比特币为例，所有的区块节点都保存了整个链上的区块信息（忽略优化省略的部分）这意味着你不仅保存了你的相关交易的区块信息，而也保存了其他人的交易信息。你保存的信息将作为一个 prover 参与到比特币的信任机制之中。

所以，区块链的分布式是‘**去中心化的分布式**’。

来，上图：

![suffix}](https://knowscount-1304485449.cos.ap-shanghai.myqcloud.com/img/5IQAYr{/suffix})

---

*等等，我会和在区块链中一样要保存所有交易记录吗？*

不会。这就是 git 的部分了。你只用保存你所贡献的记录，当然把它删掉也没得问题，但这就要求你们信赖我们能够好好保管你珍贵的文章片段了。
